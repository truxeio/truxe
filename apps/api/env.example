# ============================================================================
# Truxe API Configuration
# ============================================================================

# Application Settings
NODE_ENV=development
PORT=3001
LOG_LEVEL=info
API_VERSION=v1

# Database Configuration
DATABASE_URL=postgresql://username:password@localhost:5432/truxe.io

# Redis Configuration (for rate limiting and sessions)
REDIS_URL=redis://localhost:6379

# JWT Configuration
JWT_ALGORITHM=RS256
JWT_ISSUER=https://auth.truxe.io
JWT_AUDIENCE=truxe-api
JWT_ACCESS_TOKEN_TTL=15m
JWT_REFRESH_TOKEN_TTL=30d

# JWT Keys (RS256 - Generate using npm run generate-keys)
JWT_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----"
JWT_PUBLIC_KEY="-----BEGIN PUBLIC KEY-----\n...\n-----END PUBLIC KEY-----"

# Email Configuration
EMAIL_PROVIDER=brevo
EMAIL_FROM=noreply@truxe.io
EMAIL_FROM_NAME=Truxe Auth

# Resend Configuration
RESEND_API_KEY=re_your_api_key_here

# AWS SES Configuration (alternative to Resend)
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=your_access_key
AWS_SECRET_ACCESS_KEY=your_secret_key

# SMTP Configuration (alternative to Resend/SES)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your_email@gmail.com
SMTP_PASS=your_app_password

# Brevo Configuration (alternative to Resend/SES/SMTP)
BREVO_API_KEY=your_brevo_api_key_here

# Magic Link Configuration
MAGIC_LINK_TTL=15m
MAGIC_LINK_BASE_URL=http://localhost:3000

# Rate Limiting Configuration
RATE_LIMIT_MAGIC_LINK_PER_IP=5
RATE_LIMIT_MAGIC_LINK_WINDOW=1m
RATE_LIMIT_MAGIC_LINK_PER_EMAIL=3
RATE_LIMIT_MAGIC_LINK_EMAIL_WINDOW=1h

RATE_LIMIT_VERIFY_PER_IP=10
RATE_LIMIT_VERIFY_WINDOW=1m
RATE_LIMIT_VERIFY_PER_TOKEN=3

RATE_LIMIT_REFRESH_PER_USER=60
RATE_LIMIT_REFRESH_WINDOW=1h

# Security Configuration
BCRYPT_ROUNDS=12
CORS_ORIGIN=http://localhost:3000
CORS_CREDENTIALS=true

# Session Configuration
MAX_CONCURRENT_SESSIONS=5
SESSION_CLEANUP_INTERVAL=1h

# Feature Flags
ENABLE_SIGNUP=true
ENABLE_MAGIC_LINKS=true
ENABLE_WEBHOOKS=false
ENABLE_AUDIT_LOGS=true

# Development/Debug Settings
ENABLE_SWAGGER=true
ENABLE_REQUEST_LOGGING=true
ENABLE_METRICS=true

# Production Security Headers
ENABLE_HELMET=true
ENABLE_RATE_LIMITING=true

# Webhook Configuration (if enabled)
WEBHOOK_SECRET=your_webhook_secret_here
WEBHOOK_TIMEOUT=10s
WEBHOOK_RETRY_ATTEMPTS=3

# ============================================================================
# OAuth Configuration
# ============================================================================

OAUTH_ENABLED=true
OAUTH_CALLBACK_BASE_URL=http://localhost:3001
OAUTH_STATE_TTL=600000
OAUTH_TOKEN_ENCRYPTION_KEY=your_32_byte_encryption_key_here

# Google OAuth Configuration
GOOGLE_OAUTH_ENABLED=true
GOOGLE_OAUTH_CLIENT_ID=your_google_client_id.apps.googleusercontent.com
GOOGLE_OAUTH_CLIENT_SECRET=your_google_client_secret
GOOGLE_OAUTH_REDIRECT_URI=http://localhost:3001/auth/oauth/callback/google
GOOGLE_OAUTH_SCOPES=openid,email,profile

# ============================================================================
# GitHub OAuth Configuration
# ============================================================================

# GitHub OAuth Application Credentials
# Get these from: https://github.com/settings/developers
GITHUB_OAUTH_ENABLED=true
GITHUB_OAUTH_CLIENT_ID=your_github_client_id
GITHUB_OAUTH_CLIENT_SECRET=your_github_client_secret

# GitHub OAuth Redirect URI (must match GitHub app settings)
GITHUB_OAUTH_REDIRECT_URI=http://localhost:3001/auth/oauth/callback/github

# GitHub Default Scopes (comma-separated)
GITHUB_OAUTH_SCOPES=read:user,user:email

# GitHub API Configuration
GITHUB_API_VERSION=2022-11-28
GITHUB_USER_AGENT=Truxe-Auth

# GitHub Enterprise (optional - for self-hosted GitHub)
# GITHUB_ENTERPRISE_URL=https://github.yourcompany.com
# GITHUB_OAUTH_AUTHORIZATION_URL=https://github.yourcompany.com/login/oauth/authorize
# GITHUB_OAUTH_TOKEN_URL=https://github.yourcompany.com/login/oauth/access_token
# GITHUB_OAUTH_USERINFO_URL=https://github.yourcompany.com/api/v3/user
